@startuml
' C4 Dynamic — Frontend-only flows
!includeurl https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Dynamic.puml
LAYOUT_WITH_LEGEND()

title Frontend dynamic flows (FCM → UI)

' Elementy
Container(app, "Flutter App")
Component(handler, "FirebaseMessagingHandler", "firebase_messaging_handler.dart")
Component(localnoti, "flutter_local_notifications", "plugin")
Component(uiHome, "HomeScreen", "home_screen.dart")
Component(uiLogin, "LoginScreen", "login_screen.dart")
Component(authsvc, "AuthService", "auth_service.dart")

Container_Ext(fcm, "FCM", "", "Push do urządzenia")
Container_Ext(google, "Google Sign-In", "", "OAuth 2.0 / ID token")

' 1) Foreground push
Rel_D(fcm, handler, "1) onMessage(RemoteMessage)")
Rel_D(handler, localnoti, "2) show() — lokalne powiadomienie")

' 2) Background push
Rel_D(fcm, handler, "1b) onBackgroundMessage (globalny handler)")
Rel_D(handler, localnoti, "2b) show() — lokalne powiadomienie (background)")

' 3) Tap → otwarcie aplikacji/ekranu (opcjonalny)
Rel_D(localnoti, uiHome, "3) onSelectNotification/deepLink → HomeScreen")

' 4) Logowanie Google → UI
Rel_D(uiLogin, authsvc, "4) signIn()")
Rel_D(authsvc, google, "5) OAuth flow → ID token")
Rel_D(authsvc, uiHome, "6) onSuccess → nawigacja")

SHOW_LEGEND()
@enduml